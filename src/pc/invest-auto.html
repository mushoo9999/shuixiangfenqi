<div class="auto-title">
    <div>
        <h3>自动投标设置</h3>
    </div>
    <div class="title-right">
        <a href="#">《自动投标协议》</a>
    </div>
</div>
<div class="auto-flow-wrap">
    <div class="dashed-bg"></div>
    <h4>自动投标流程</h4>
    <ul class="auto-flow clearfix">
        <li class="auto-set">设置/开启自动投标</li>
        <li class="auto-wait">排队等待</li>
        <li class="auto-start">自动投标</li>
    </ul>
</div>
<div class="auto-plan">
    <div class="plan-desc">当前开启自动投标人数<em>32582</em>位，您当前排在第<em>32582</em>位，快来一起体验您的智能投资管家，抢标快人一步！</div>
    <div class="plan-item-wrap clearfix">
        <div class="plan-item">
            <div class="plan-item-none plan-item-none-1"></div>
            <div class="plan-added plan-added-1" style="display: none;">
                <div class="added-title clearfix">
                    <h4>投标方案一</h4>
                    <div class="added-switch">
                        <div class="switch-wrap clearfix">
                            <span class="added-on">已开启</span><i class="added-circle"></i><span class="added-off">已关闭</span>
                        </div>
                    </div>
                </div>
                <div class="added-content">
                    <p>账户保留金额：<em></em></p>
                    <div class="added-row clearfix">
                        <p>投资利率区间：<em></em></p>
                        <p>投资标的时间：<em></em></p>
                    </div>
                    <div class="added-row clearfix">
                        <p>到期方式：<em></em></p>
                        <p>还款方式：<em></em></p>
                    </div>
                </div>
                <div class="added-btns">
                    <span class="added-del added-del-1">删除</span>
                    <span class="added-mod added-mod-1">修改</span>
                </div>
            </div>
        </div>
        <div class="plan-item">
            <div class="plan-item-none plan-item-none-2"></div>
            <div class="plan-added plan-added-2" style="display: none;">
                <div class="added-title clearfix">
                    <h4>投标方案二</h4>
                    <div class="added-switch">
                        <div class="switch-wrap clearfix">
                            <span class="added-on">已开启</span><i class="added-circle"></i><span class="added-off">已关闭</span>
                        </div>
                    </div>
                </div>
                <div class="added-content">
                    <p>账户保留金额：<em></em></p>
                    <div class="added-row clearfix">
                        <p>投资利率区间：<em></em></p>
                        <p>投资标的时间：<em></em></p>
                    </div>
                    <div class="added-row clearfix">
                        <p>到期方式：<em></em></p>
                        <p>还款方式：<em></em></p>
                    </div>
                </div>
                <div class="added-btns">
                    <span class="added-del added-del-2">删除</span>
                    <span class="added-mod added-mod-2">修改</span>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- 弹窗 -->
<div class="plan-popup" style="display: none;">
    <div class="cover"></div>
    <div class="popup-box">
        <div class="popup-title">
            <span>自动投标设置</span>
            <div class="close-btn"></div>
        </div>
        <div class="popup-content">
            <div class="poup-item clearfix">
                <div class="popup-desc">
                    账户保留金额
                </div>
                <div class="popup-detail clearfix">
                    <div class="popup-radio">
                        无需保留
                    </div>
                    <div class="popup-radio">
                        需要保留
                    </div>
                    <div class="popup-input">
                        <input type="text">元
                    </div>
                </div>
            </div>
            <div class="poup-item clearfix">
                <div class="popup-desc">
                    利率
                </div>
                <div class="popup-detail clearfix">
                    <div class="popup-checkbox">
                        5% ~ 9%
                    </div>
                    <div class="popup-checkbox">
                        9% ~ 11%
                    </div>
                    <div class="popup-checkbox">
                        11%以上
                    </div>
                </div>
            </div>
            <div class="poup-item clearfix">
                <div class="popup-desc">
                    时间
                </div>
                <div class="popup-detail clearfix">
                    <div class="popup-checkbox">
                        一个月
                    </div>
                    <div class="popup-checkbox">
                        三个月
                    </div>
                    <div class="popup-checkbox">
                        三个月以上
                    </div>
                </div>
            </div>
            <div class="poup-item clearfix">
                <div class="popup-desc">
                    类型
                </div>
                <div class="popup-detail clearfix">
                    <div class="popup-checkbox">
                        优选理财计划
                    </div>
                    <div class="popup-checkbox">
                        精选理财
                    </div>
                </div>
            </div>
            <div class="poup-item clearfix">
                <div class="popup-desc">
                    到期方式
                </div>
                <div class="popup-detail clearfix">
                    <div class="popup-checkbox">
                        还本付息
                    </div>
                    <div class="popup-checkbox">
                        先息后本
                    </div>
                </div>
            </div>
            <div class="poup-item clearfix">
                <div class="popup-desc">
                    还款方式
                </div>
                <div class="popup-detail clearfix">
                    <div class="popup-checkbox">
                        还本付息
                    </div>
                    <div class="popup-checkbox">
                        到期还本
                    </div>
                    <div class="popup-checkbox">
                        等额本息
                    </div>
                </div>
            </div>
            <div class="poup-item clearfix">
                <div class="popup-desc">
                    自动投标协议
                </div>
                <div class="popup-detail clearfix">
                    <div class="popup-checkbox">
                        我已阅读并同意
                    </div>
                    <div class="popup-agreement">
                        <a href="#">《自动投标协议》</a>
                    </div>
                </div>
            </div>
            <div class="popup-btn">
                <button>确定</button>
            </div>
        </div>
    </div>
</div>
<!-- 删除弹窗 -->
<div class="del-popup" style="display: none;">
    <div class="cover"></div>
    <div class="del-box">
        <div class="del-title">
            投资方案一
        </div>
        <div class="del-content">
            是否删除？
        </div>
        <div class="del-btns clearfix">
            <button class="del-confirm">确定</button>
            <button class="del-cancel">取消</button>
        </div>
    </div>
</div>
<div class="auto-rule">
    <h4>自动投标规则：</h4>
    <ul>
        <li>1、新标上线即会启动自动投标功能；</li>
        <li>2、单笔投标金额若超过所投标借款总额的50%，则以总标额的50%为上限向下取该标最小出借单位的整数倍进行投标。</li>
        <li>3、自动投标功能设置中若没有设置预留金额，系统将默认用户账户内全部可用余额用于自动投标。</li>
        <li>4、投标排序规则如下：
            <ul>
                <li>a ) 投标顺序按照开启自动投标的时间先后进行排序；</li>
                <li>b ) 每个用户投标后，重新回到队尾，依次循环进行投标； </li>
                <li>c ) 轮到用户进行投标时，若没有标符合用户设置的自动投标条件，视为自动放弃此次投标机会，重新排队；</li>
                <li>d ) 轮到用户投标时，若同时有多个标符合自动投标设置，则按照优先级根据用户第一条设置进行投标；</li>
            </ul>
        </li>
    </ul>
</div>
<script type="text/javascript">
$(function() {
    //开关按钮
    onOff();
    modPlan();
    addPlan();

    closeBtn();
});

//单选按钮
function radio() {
    $('.popup-radio').unbind('click').on('click', function() {
        $(this).addClass('popup-radio-active').siblings('.popup-radio').removeClass('popup-radio-active');
        if ($('.popup-radio').eq(1).hasClass('popup-radio-active')) {
            $('.popup-input').show();
        } else {
            $('.popup-input').hide();
        }
        confirmBtn();
    });

}

//多选框
function check() {
    $('.popup-checkbox').unbind('click').on('click', function() {
        if ($(this).hasClass('popup-checkbox-active')) {
            $(this).removeClass('popup-checkbox-active');
        } else {
            $(this).addClass('popup-checkbox-active');
        }
        confirmBtn();
    });
}

//弹窗确定按钮激活
function confirmBtn() {
    if ($('.poup-item').eq(0).find('.popup-radio').hasClass('popup-radio-active') && $('.poup-item').eq(1).find('.popup-checkbox').hasClass('popup-checkbox-active') && $('.poup-item').eq(2).find('.popup-checkbox').hasClass('popup-checkbox-active') && $('.poup-item').eq(3).find('.popup-checkbox').hasClass('popup-checkbox-active') && $('.poup-item').eq(4).find('.popup-checkbox').hasClass('popup-checkbox-active') && $('.poup-item').eq(5).find('.popup-checkbox').hasClass('popup-checkbox-active') && $('.poup-item').eq(6).find('.popup-checkbox').hasClass('popup-checkbox-active')) {
        $('.popup-btn').addClass('popup-btn-active');
    } else {
        $('.popup-btn').removeClass('popup-btn-active');
    }
}

//添加方案
function addPlan() {
    $('.plan-item-none').unbind('click').on('click', function() {
        $('.plan-popup').show();
        cleanPop();
        radio();
        check();
        addBtn();

    });

}

//修改方案
function modPlan() {
    $(".added-btns span").unbind('click').on("click", function(event) {
        event.stopPropagation();
        var that = this;
        var pItem = $(that).parents(".plan-item");

        if ($(that).hasClass("added-del")) {

            $(".del-popup").show();
            $(".del-popup .del-confirm").unbind('click').one("click", function() {
                $(".del-popup").hide();
                pItem.find(".plan-added").hide().end().find(".plan-item-none").show();
                if ($('.plan-added-1').css('display') == 'none' && $('.plan-added-2').css('display') == 'none'){
                    $('.plan-desc').slideUp('fast');
                }
            });
            $(".del-popup .del-cancel").unbind('click').one("click",function() {
                $(".del-popup").hide();
            });

        } else {
            $('.plan-popup').show();
            $('.popup-btn button').unbind('click').one('click', function() {
                if (pItem.siblings().find(".plan-added").css('display') == 'none') {
                    $('.plan-popup').hide();
                    pItem.siblings().find(".plan-added").hide();
                } else {
                    $('.plan-popup').hide();
                }

            });
        }
    });
}

// 关闭按钮
function closeBtn() {
    $('.close-btn').unbind('click').on('click', function() {
        $('.plan-popup').hide();
    })
}

//清空弹框
function cleanPop() {
    $('.poup-item').each(function() {
        $(this).find('.popup-radio').removeClass('popup-radio-active');
        $(this).find('.popup-checkbox').removeClass('popup-checkbox-active')
    });
    $('.popup-input input').val('');
    $('.popup-btn').removeClass('popup-btn-active');
}

//弹窗确定按钮
function addBtn() {

    $('.popup-btn button').unbind('click').one('click', function() {
        $('.plan-popup').hide();
        if ($('.plan-added-1').css('display') == 'none') {
            $('.plan-item-none-1').hide();
            $('.plan-added-1').show();
            $('.plan-desc').slideDown('fast');
        } else {
            $('.plan-item-none-2').hide();
            $('.plan-added-2').show();
        }

    });

}

// 方案开关
function onOff() {
    $('.switch-wrap').unbind('click').on('click', function() {
        if ($(this).css('left') == '0px') {
            $(this).filter(':not(:animated)').animate({
                left: '-50px'
            }, 300)
        } else {
            $(this).filter(':not(:animated)').animate({
                left: '0px'
            }, 300)
        }
    })
}
</script>
